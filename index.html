<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Controle de Grana</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>

  <!-- LOCK SCREEN -->
  <div id="lockScreen" class="lock hidden">
    <div class="lockCard">
      <h2>üîí Protegido por PIN</h2>
      <p>Digite seu PIN para acessar.</p>
      <div class="lockRow">
        <input id="pinInput" type="password" inputmode="numeric" placeholder="PIN" />
        <button id="btnUnlock" class="btn ok">Entrar</button>
      </div>
      <small class="muted">Obs: √© prote√ß√£o local (n√£o √© ‚Äúbanco‚Äù).</small>
    </div>
  </div>

  <header class="wrap">
    <div class="title">
      <h1>Controle de Grana</h1>
      <p>Renda ‚Ä¢ Contas ‚Ä¢ Aportes ‚Ä¢ D√≠vida ‚Ä¢ Reserva ‚Ä¢ Metas ‚Ä¢ Gr√°ficos (salva no navegador)</p>
    </div>

    <div class="actions">
      <button id="btnExport" class="btn ghost">Exportar JSON</button>
      <label class="btn ghost file">
        Importar JSON
        <input id="fileImport" type="file" accept="application/json" />
      </label>
      <button id="btnReset" class="btn danger">Zerar dados</button>
    </div>
  </header>

  <main class="wrap grid">

    <!-- SETTINGS / SECURITY -->
    <section class="card">
      <h2>Configura√ß√µes</h2>

      <div class="grid2">
        <div class="field">
          <label>Modo Uber (calcular sua renda automaticamente)</label>
          <select id="uberMode">
            <option value="manual">Manual (voc√™ digita renda mensal)</option>
            <option value="auto">Autom√°tico (di√°ria + b√¥nus + dias)</option>
            <option value="weekly">Semanal (voc√™ preenche por semana)</option>
          </select>
        </div>

        <div class="field">
          <label>Dias no m√™s (padr√£o 30 / Uber real 25)</label>
          <select id="workDays">
            <option value="30">30 dias</option>
            <option value="25">25 dias</option>
          </select>
        </div>
      </div>

      <hr />

      <h3 class="sub">PIN (prote√ß√£o local)</h3>
      <div class="grid2">
        <div class="field">
          <label>Novo PIN</label>
          <input id="pinNew" type="password" inputmode="numeric" placeholder="Crie um PIN (ex: 1234)" />
        </div>
        <div class="field">
          <label>Confirmar PIN</label>
          <input id="pinConfirm" type="password" inputmode="numeric" placeholder="Confirme o PIN" />
        </div>
      </div>
      <div class="row">
        <button id="btnSetPin" class="btn">Salvar PIN</button>
        <button id="btnRemovePin" class="btn danger">Remover PIN</button>
      </div>

      <p class="hint">PIN s√≥ bloqueia no seu aparelho/navegador. Se apagar o storage, some.</p>
    </section>

    <!-- GOALS -->
    <section class="card">
      <h2>Metas</h2>
      <div class="grid2">
        <div class="field">
          <label>Meta: ficar sem d√≠vidas at√©</label>
          <input id="goalDebtDate" type="month" />
        </div>
        <div class="field">
          <label>Meta: reserva (meses de contas)</label>
          <select id="goalReserveMonths">
            <option value="3">3 meses</option>
            <option value="6" selected>6 meses</option>
            <option value="9">9 meses</option>
            <option value="12">12 meses</option>
          </select>
        </div>
      </div>

      <div class="stats">
        <div class="stat">
          <span>Previs√£o quita√ß√£o (estim.)</span>
          <strong id="goalDebtETA">‚Äî</strong>
        </div>
        <div class="stat">
          <span>Status meta d√≠vidas</span>
          <strong id="goalDebtStatus">‚Äî</strong>
        </div>
        <div class="stat">
          <span>Meta reserva (R$)</span>
          <strong id="goalReserveValue">R$ 0,00</strong>
        </div>
        <div class="stat">
          <span>Meses p/ bater a meta reserva</span>
          <strong id="goalReserveETA">‚Äî</strong>
        </div>
      </div>

      <p class="hint">Tudo aqui √© estimativa simples (sem juros). Serve pra dire√ß√£o.</p>
    </section>

    <!-- INPUTS -->
    <section class="card full">
      <h2>Entradas do m√™s</h2>

      <!-- Uber AUTO -->
      <div id="uberAutoBox" class="subbox hidden">
        <h3 class="sub">Uber autom√°tico</h3>
        <div class="grid2">
          <div class="field">
            <label>Di√°ria (R$)</label>
            <input id="uberDaily" type="number" min="0" step="0.01" placeholder="Ex: 200" />
          </div>
          <div class="field">
            <label>B√¥nus (% sobre a di√°ria anterior fixada)</label>
            <input id="uberBonusPct" type="number" min="0" step="0.01" placeholder="Ex: 20" />
          </div>
        </div>
        <p class="hint">Ex: 200 + 20% = 240/dia. Com 30 dias: 7.200.</p>
      </div>

      <!-- Uber WEEKLY -->
      <div id="uberWeeklyBox" class="subbox hidden">
        <h3 class="sub">Uber semanal</h3>
        <div class="tableWrap">
          <table>
            <thead>
              <tr>
                <th>Semana</th>
                <th>Quanto entrou (R$)</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Semana 1</td><td><input id="w1" class="tableInput" type="number" min="0" step="0.01" placeholder="0" /></td></tr>
              <tr><td>Semana 2</td><td><input id="w2" class="tableInput" type="number" min="0" step="0.01" placeholder="0" /></td></tr>
              <tr><td>Semana 3</td><td><input id="w3" class="tableInput" type="number" min="0" step="0.01" placeholder="0" /></td></tr>
              <tr><td>Semana 4</td><td><input id="w4" class="tableInput" type="number" min="0" step="0.01" placeholder="0" /></td></tr>
              <tr><td>Semana 5 (se tiver)</td><td><input id="w5" class="tableInput" type="number" min="0" step="0.01" placeholder="0" /></td></tr>
            </tbody>
          </table>
        </div>
        <p class="hint">Preenche o que entrou por semana e o sistema soma sua renda do m√™s.</p>
      </div>

      <div class="grid2">
        <div class="field">
          <label>Sua renda do m√™s (Uber) ‚Äî (manual OU calculada)</label>
          <input id="incomeYou" type="number" min="0" step="0.01" placeholder="Ex: 7200" />
        </div>
        <div class="field">
          <label>Renda (Mulher)</label>
          <input id="incomeWife" type="number" min="0" step="0.01" placeholder="Ex: 3000" />
        </div>

        <div class="field">
          <label>Extras (por fora)</label>
          <input id="incomeExtra" type="number" min="0" step="0.01" placeholder="Ex: 500" />
        </div>
        <div class="field">
          <label>Contas fixas</label>
          <input id="fixedCosts" type="number" min="0" step="0.01" placeholder="Ex: 5000" />
        </div>

        <div class="field">
          <label>Aporte em d√≠vidas (m√™s)</label>
          <input id="debtPay" type="number" min="0" step="0.01" placeholder="Ex: 4000" />
        </div>
        <div class="field">
          <label>Reserva de emerg√™ncia (m√™s)</label>
          <input id="reserveAdd" type="number" min="0" step="0.01" placeholder="Ex: 1200" />
        </div>

        <div class="field">
          <label>D√≠vida total atual</label>
          <input id="debtTotal" type="number" min="0" step="0.01" placeholder="Ex: 60000" />
        </div>
        <div class="field">
          <label>Reserva atual (se j√° tiver)</label>
          <input id="reserveTotal" type="number" min="0" step="0.01" placeholder="Ex: 2000" />
        </div>
      </div>

      <div class="row">
        <button id="btnSave" class="btn">Salvar</button>
        <button id="btnCloseMonth" class="btn ok">Fechar m√™s (salvar hist√≥rico)</button>
      </div>

      <p class="hint">Tudo fica s√≥ no seu navegador (localStorage). Pode exportar/importar JSON.</p>
    </section>

    <!-- SUMMARY -->
    <section class="card">
      <h2>Resumo</h2>

      <div class="stats">
        <div class="stat">
          <span>Renda total</span>
          <strong id="sumIncome">R$ 0,00</strong>
        </div>
        <div class="stat">
          <span>Gastos fixos</span>
          <strong id="sumFixed">R$ 0,00</strong>
        </div>
        <div class="stat">
          <span>Aportes (d√≠vida + reserva)</span>
          <strong id="sumAports">R$ 0,00</strong>
        </div>
        <div class="stat">
          <span>Sobra do m√™s</span>
          <strong id="sumLeft" class="good">R$ 0,00</strong>
        </div>
      </div>

      <hr />

      <div class="stats">
        <div class="stat">
          <span>D√≠vida restante (estimada)</span>
          <strong id="sumDebtAfter">R$ 0,00</strong>
        </div>
        <div class="stat">
          <span>Meses p/ quitar (estim.)</span>
          <strong id="sumMonths">‚Äî</strong>
        </div>
        <div class="stat">
          <span>Reserva ap√≥s aporte</span>
          <strong id="sumReserveAfter">R$ 0,00</strong>
        </div>
        <div class="stat">
          <span>Meta reserva (auto)</span>
          <strong id="sumReserveGoal">R$ 0,00</strong>
        </div>
      </div>

      <div class="barWrap">
        <div class="barLabel">
          <span>Aloca√ß√£o do m√™s</span>
          <span id="sumPerc">‚Äî</span>
        </div>
        <div class="bar">
          <div id="barFixed" class="seg fixed" title="Fixos"></div>
          <div id="barDebt" class="seg debt" title="D√≠vida"></div>
          <div id="barReserve" class="seg reserve" title="Reserva"></div>
          <div id="barLeft" class="seg left" title="Sobra"></div>
        </div>
        <div class="legend">
          <span><i class="dot fixed"></i> Fixos</span>
          <span><i class="dot debt"></i> D√≠vida</span>
          <span><i class="dot reserve"></i> Reserva</span>
          <span><i class="dot left"></i> Sobra</span>
        </div>
      </div>
    </section>

    <!-- CHARTS -->
    <section class="card">
      <h2>Gr√°ficos</h2>
      <div class="chartBox">
        <h3 class="sub">Hist√≥rico: D√≠vida x Reserva</h3>
        <canvas id="chartHistory" width="520" height="260"></canvas>
      </div>
      <div class="chartBox">
        <h3 class="sub">Distribui√ß√£o do m√™s</h3>
        <canvas id="chartAlloc" width="520" height="260"></canvas>
      </div>
      <p class="hint">Gr√°ficos simples, sem libs externas (roda liso no GitHub Pages).</p>
    </section>

    <!-- HISTORY -->
    <section class="card full">
      <h2>Hist√≥rico (meses fechados)</h2>
      <div class="row">
        <button id="btnClearHistory" class="btn ghost">Limpar hist√≥rico</button>
      </div>
      <div class="tableWrap">
        <table>
          <thead>
            <tr>
              <th>M√™s</th>
              <th>Renda</th>
              <th>Fixos</th>
              <th>D√≠vida</th>
              <th>Reserva</th>
              <th>Sobra</th>
              <th>D√≠vida ap√≥s</th>
              <th>Reserva ap√≥s</th>
            </tr>
          </thead>
          <tbody id="historyBody"></tbody>
        </table>
      </div>
    </section>

  </main>

  <footer class="wrap footer">
    <small>Controle simples ‚Ä¢ GitHub Pages ‚Ä¢ localStorage</small>
  </footer>

  <script src="./app.js"></script>
</body>
</html>
